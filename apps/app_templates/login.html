{% extends 'layouts/base-fullscreen.html' %}
{% load static i18n %}
{% block title %} Login {% endblock title %}
{% block stylesheets %}
<!-- Shepherd.js CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/shepherd.js/dist/css/shepherd.css">
{% endblock stylesheets %}
{% block content %}
<!-- Page content -->
<div class="container position-sticky z-index-sticky top-0">
    <div class="row">
        <div class="col-12"></div>
    </div>
</div>
{% include "includes/navigation-fullscreen.html" %}
<main class="main-content mt-0">
    <div class="page-header align-items-start min-vh-50 pt-7 pb-9 m-3 border-radius-lg position-relative" data-step="1" style="overflow: hidden; min-height: 50vh; border-radius: 1rem;">
<video autoplay loop muted playsinline
    style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; border-radius: inherit">
    <source src="{% static 'assets/img/bv1.mp4' %}" type="video/mp4">
    Your browser does not support the video tag.
</video>
        <span class="mask bg-gradient-dark opacity-6 position-absolute top-0 start-0 w-100 h-100" ></span>
        <div class="container position-relative" >
            <div class="row justify-content-center">
                <div class="col-lg-5 text-center mx-auto">
                    <h1 class="text-white mb-2 mt-5">{% trans "Delil Turkiye  " %}</h1>
                    <p class="text-lead text-white">{% trans "Welcome to Delil Turkiye  Medical Tourism ! providing comprehensive healthcare solutions." %}</p>
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row mt-lg-n10 mt-md-n11 mt-n10 justify-content-center"> 
            <div class="col-xl-4 col-lg-5 col-md-7 mx-auto">
                <div class="card" data-step="2">
                    <div class="card-header pb-0 text-start">
                        <h4 class="font-weight-bolder">{% trans "Sign In" %}</h4>
                        <p class="mb-0">{% trans "Enter your email and password to sign in" %}</p>
                    </div>
                    <div class="card-body">
                        <form role="form" action="{% url 'app:login' %}" method="post">
                            {% csrf_token %}
                            {% if error_message %}
                            <div class="alert alert-danger" role="alert">
                                {{ error_message }}
                            </div>
                            {% endif %}
                            <div class="mb-3" data-step="3">
                                <input type="email" name="email" class="form-control form-control-lg" placeholder="Email" aria-label="Email" required autofocus>
                            </div>
                            <div class="mb-3" data-step="4">
                                <input type="password" name="password" class="form-control form-control-lg" placeholder="Password" aria-label="Password" required>
                            </div>
                            <div class="form-check form-switch" data-step="5">
                                <input class="form-check-input" type="checkbox" id="rememberMe" name="remember" checked>
                                <label class="form-check-label" for="rememberMe">{% trans "Remember me" %}</label>
                            </div>
                            <div class="text-center" data-step="6">
                                <button type="submit" class="btn btn-lg btn-primary w-100 mt-4 mb-0">{% trans "Sign in" %}</button>
                            </div>
                        </form>
                    </div>
                    <div class="card-footer text-center pt-0 px-lg-2 px-1" data-step="7">
                        <p class="mb-4 text-sm mx-auto">{% trans "Don't have an account?" %}<a href="{% url 'app:signup' %}" class="text-primary text-gradient font-weight-bold">{% trans "Sign up!" %}</a>
                        </p>
                    </div>
                </div>
                 {% include "includes/footer-fullscreen.html" %}
   
            </div>
        </div>
    </div>

</main>
{% endblock content %}

{% block javascripts %}
<!-- Shepherd.js -->
<script src="https://cdn.jsdelivr.net/npm/shepherd.js@9.1.1/dist/js/shepherd.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function() {
    console.log("DOMContentLoaded event fired, initializing Shepherd.js...");

    // Shepherd.js tour setup
    const tour = new Shepherd.Tour({
        useModalOverlay: true,
        defaultStepOptions: {
            cancelIcon: { enabled: true },
            scrollTo: { behavior: 'smooth', block: 'center' },
            classes: 'shadow-md bg-purple-dark'
        }
    });

    // Add steps with debug logs
    tour.addStep({
        id: 'step-1',
        text: '{% trans "This is the welcome message for Delil Turkiye  Medical Tourism , providing comprehensive healthcare solutions." %}',
        attachTo: {
            element: '[data-step="1"]',
            on: 'bottom'
        },
        buttons: [{ text: '{% trans "Next" %}', action: tour.next }],
        when: {
            show: () => console.log('Showing step-1: attached to [data-step="1"]')
        }
    });

    tour.addStep({
        id: 'step-2',
        text: '{% trans "This card contains the login form where you can enter your credentials." %}',
        attachTo: {
            element: '[data-step="2"]',
            on: 'right'
        },
        buttons: [{ text: '{% trans "Next" %}', action: tour.next }],
        when: {
            show: () => console.log('Showing step-2: attached to [data-step="2"]')
        }
    });

    tour.addStep({
        id: 'step-3',
        text: '{% trans "Enter your email here." %}',
        attachTo: {
            element: '[data-step="3"]',
            on: 'top'
        },
        buttons: [{ text: '{% trans "Next" %}', action: tour.next }],
        when: {
            show: () => console.log('Showing step-3: attached to [data-step="3"]')
        }
    });

    tour.addStep({
        id: 'step-4',
        text: '{% trans "Enter your password here." %}',
        attachTo: {
            element: '[data-step="4"]',
            on: 'top'
        },
        buttons: [{ text: '{% trans "Next" %}', action: tour.next }],
        when: {
            show: () => console.log('Showing step-4: attached to [data-step="4"]')
        }
    });

    tour.addStep({
        id: 'step-5',
        text: '{% trans "Use this checkbox to keep yourself logged in." %}',
        attachTo: {
            element: '[data-step="5"]',
            on: 'top'
        },
        buttons: [{ text: '{% trans "Next" %}', action: tour.next }],
        when: {
            show: () => console.log('Showing step-5: attached to [data-step="5"]')
        }
    });

    tour.addStep({
        id: 'step-6',
        text: '{% trans "Click here to sign in." %}',
        attachTo: {
            element: '[data-step="6"]',
            on: 'top'
        },
        buttons: [{ text: '{% trans "Next" %}', action: tour.next }],
        when: {
            show: () => console.log('Showing step-6: attached to [data-step="6"]')
        }
    });

    tour.addStep({
        id: 'step-7',
        text: '{% trans "If you dont have an account, click here to sign up." %}',
        attachTo: {
            element: '[data-step="7"]',
            on: 'top'
        },
        buttons: [{ text: '{% trans "Done" %}', action: tour.complete }],
        when: {
            show: () => console.log('Showing step-7: attached to [data-step="7"]')
        }
    });

    // Attach event listener to the universal button (if it exists)
    const tutorialBtn = document.getElementById('universal-tutorial-btn');
    if (tutorialBtn) {
        tutorialBtn.addEventListener('click', function(e) {
            e.preventDefault();
            console.log("Universal tutorial button clicked. Starting the tour...");
            try {
                tour.start();
            } catch (error) {
                console.error("Error starting Shepherd tour:", error);
            }
        });
    } else {
        console.log("Tutorial button not found on this page - this is normal for login page");
    }

    // Debug checks to ensure all data-step elements exist
    const steps = [1, 2, 3, 4, 5, 6, 7];
    steps.forEach(step => {
        const element = document.querySelector(`[data-step="${step}"]`);
        if (element) {
            console.log(`Element for step-${step} found:`, element);
        } else {
            console.warn(`Element for step-${step} NOT found!`);
        }
    });
});

</script>
{% endblock javascripts %}

